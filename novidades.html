<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
    <title>Penedo Riders</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />
    <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href='https://fonts.googleapis.com/css?family=Lato:400,300' rel='stylesheet' type='text/css' />
</head>

<body>

<div class="navbar-fixed">
    <nav class="nav-wrapper grey darken-4">
        <h4 class="center-align titleApp">Novidades</h4>
    </nav>
</div>

<div>
    <div class="row">
        <div class="col s12">
            <ul class="tabs">
                <li class="tab col s6"><a class="active" href="#noticias">Not√≠cias</a></li>
                <li class="tab col s6"><a href="#blog">Blog</a></li>
            </ul>
        </div>

        <div id="noticias" class="col s12 abaMoto">
            <br/>
            <div id="listViewNoticias" style="margin-bottom: 35px;"></div>
            <script type="text/x-kendo-template" id="templateNoticia">
                <div class="card cardNoticias">
                    <div class="card-content" style="padding: 0 15px;">
                        <div style="overflow: hidden;font-size: 11px;margin: 5px 0;">
                            <span style="float: left;">${autor}</span>
                            <span style="float: right;">#= moment(datahora).fromNow() #</span>
                        </div>
                        <h5 class="card-title activator grey-text text-darken-4" style="font-size: 16px;font-style: normal;font-weight: bold;padding: 0;margin: 0;line-height: 22px;">${titulo}</h5>
                        # descricao = descricao.replace(/(<([^>]+)>)/ig,"") #
                        #if(descricao.length >= 150){#
                            # descricao = descricao.substring(0,150)#
                            # descricao = descricao + '...'#
                        #}#
                        <div style="margin-top: 6px;">#= descricao #</div>
                    </div>
                </div>

            </script>
        </div>

        <div id="blog" class="col s12">
            <br/>
            <div id="listViewBlog" style="margin-bottom: 70px;"></div>
            <script type="text/x-kendo-template" id="templateBlog">
                <div class="card item">
                    <div class="card-image">
                        <img src="#=img#" alt="${titulo}" />
                    </div>
                    <div class="card-content" style="padding: 0 15px 15px 15px;">
                        <div style="overflow: hidden;font-size: 11px;margin: 0;font-weight: bold;color: rgb(128,128,128);">
                            <span style="float: left;">${autor}Bruna Brito</span>
                            <span style="float: right;">#= moment(datahora).fromNow() #</span>
                        </div>
                        <h5 style="margin: 5px 0;font-weight: bold;">${titulo}</h5>
                        # descricao = descricao.replace(/(<([^>]+)>)/ig,"") #
                        #if(descricao.length >= 150){#
                        # descricao = descricao.substring(0,150)#
                        # descricao = descricao + '...'#
                        #}#
                        <div style="margin-top: 6px;">#= descricao #</div>
                    </div>
                </div>
            </script>
        </div>

    </div>
</div>

<div class="navbar-fixed footer">
    <nav class="nav-wrapper grey darken-4">
        <ul class="center row">
            <li class="col s2 offset-s1"><a href="motoclube.html"><i class="fa fa-motorcycle"></i></a></li>
            <li class="col s2"><a href="novidades.html"><i class="fa fa-newspaper-o"></i></a></li>
            <li class="col s2"><a href="social/social.html"><i class="fa fa-users"></i></a></li>
            <li class="col s2"><a href="eventos.html"><i class="fa fa-calendar"></i></a></li>
            <li class="col s2"><a href="fotos.html"><i class="fa fa-photo"></i></a></li>
        </ul>
    </nav>
</div>

<!--  Scripts-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js"></script>
<script src="http://cdn.kendostatic.com/2014.1.318/js/kendo.all.min.js"></script>
<script src="js/materialize.js"></script>
<script type="text/javascript" src="js/main.js"></script>
<script type="text/javascript" src="js/moment-with-locales.js"></script>

<!-- Index -->
<script type="text/javascript" src="cordova.js"></script>

<!--<script type="text/javascript">-->
    <!--app.initialize();-->
<!--</script>-->

<noscript>
    <div style="display:inline;">
        <img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/966923546/?value=0&amp;guid=ON&amp;script=0"/>
    </div>

</noscript>

<script>

    $(function() {

        moment.locale('pt-BR');

        $.ajax({
            type: "GET", /* tipo get */
            url: "http://penedoriders.com.br/php/site/open/noticias.php",
            contentType: 'text/plain; charset=utf-8',
            xhrFields: {
                withCredentials: false
            },
            headers: {},
            success: function(retorno) {

                retorno = $.parseJSON(retorno); //converter JSON em Array;

                for (var i = 0, lenI = retorno.length; i < lenI; i++) {
                    if(retorno[i].datahora) {
                        retorno[i].datahora = new Date(retorno[i].datahora);
                    }
                }

                var dataSource = new kendo.data.DataSource({
                    data:  retorno,
                    sort: { field: "datahora", dir: "asc" }
                });

                $("#listViewNoticias").kendoListView({
                    dataSource: dataSource,
                    selectable: true,
                    change: function(e){
                        var data = e.sender.dataSource.view();
                        jQuery.map(e.sender.select(), function (item) {
                            var selecionado = data[jQuery(item).index()];
                            localStorage.setItem("not_id", selecionado.id);
                            window.location.href = "single/novidades-noticia.html";
                        });
                    },
                    template: kendo.template($("#templateNoticia").html())
                });

            },
            error: function() {
                toastr.error('Desculpe, ocorreu um erro');
                window.location.href = 'index.html';
            }
        });

        $.ajax({
            type: "GET", /* tipo get */
            url: "http://penedoriders.com.br/php/site/open/blog.php",
            contentType: 'text/plain; charset=utf-8',
            xhrFields: {
                withCredentials: false
            },
            headers: {},
            success: function(retorno) {

                retorno = $.parseJSON(retorno); //converter JSON em Array;

                for (var i = 0, lenI = retorno.length; i < lenI; i++) {
                    if(retorno[i].datahora) {
                        retorno[i].datahora = new Date(retorno[i].datahora);
                    }
                }

                var dataSource = new kendo.data.DataSource({
                    data:  retorno,
                    sort: { field: "datahora", dir: "asc" }
                });

                $("#listViewBlog").kendoListView({
                    dataSource: dataSource,
                    selectable: true,
                    change: function(e){
                        var data = e.sender.dataSource.view();
                        jQuery.map(e.sender.select(), function (item) {
                            var selecionado = data[jQuery(item).index()];
                            localStorage.setItem("blog_id", selecionado.id);
                            window.location.href = "single/novidades-blog.html";
                        });
                    },
                    template: kendo.template($("#templateBlog").html())
                });

            },
            error: function() {
                toastr.error('Desculpe, ocorreu um erro');
                window.location.href = 'index.html';
            }
        });

    });

</script>

</body>

</html>